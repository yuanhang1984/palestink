<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE xml>
<config>
    <dispatch>
        <servlet>
            <name>addRole</name>
            <description><![CDATA[添加角色]]></description>
            <namespace>
                <![CDATA[
                    [!select][user_security][selectRole][name];
                    [insert][user_security][insertRole][uuid,name,description,permission_list];
                    [select][user_security][selectRole][uuid];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>#constant#</format>
                    <constant>#uuid</constant>
                </parameter>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>description</name>
                    <description><![CDATA[描述（2-64位下汉子、划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[\u4e00-\u9fffa0-9a-zA-Z_-]{2,64}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>permission_list</name>
                    <description><![CDATA[权限集合（分号分隔的数字、大小写字母、下划线、横线和“.”）]]></description>
                    <type>string</type>
                    <format>^([0-9a-zA-Z_\-\.]{3,};)+$</format>
                    <allowNull>false</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>removeRole</name>
            <description><![CDATA[删除角色]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectRole][uuid];
                    [delete][user_security][deleteRole][uuid];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z]{32}$</format>
                    <allowNull>false</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>modifyRole</name>
            <description><![CDATA[修改角色]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectRole][uuid];
                    [!select][user_security][selectRole][uuid->ne_uuid,name];
                    [update][user_security][updateRole][uuid,name,description,permission_list];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z]{32}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（必选项，否则第2个SQL将无法通过）（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>description</name>
                    <description><![CDATA[描述（2-64位下汉子、划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[\u4e00-\u9fffa0-9a-zA-Z_-]{2,64}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>permission_list</name>
                    <description><![CDATA[权限集合（分号分隔的数字、大小写字母和“.”）]]></description>
                    <type>string</type>
                    <format>^([0-9a-zA-Z_\-\.]{3,};)+$</format>
                    <allowNull>true</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>getRole</name>
            <description><![CDATA[获取角色]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectRole][uuid,name,description];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z]{32}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>description</name>
                    <description><![CDATA[描述（2-64位下汉子、划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[\u4e00-\u9fffa0-9a-zA-Z_-]{2,64}$</format>
                    <allowNull>true</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>addUserByManager</name>
            <description><![CDATA[添加用户（管理员）]]></description>
            <namespace>
                <![CDATA[
                    [!select][user_security][selectUser][name];
                    [insert][user_security][insertUser][uuid,name,password,role,failed_retry_count,frozen_datetime,status];
                    [select][user_security][selectUser][uuid];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>#constant#</format>
                    <constant>#uuid</constant>
                </parameter>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>password</name>
                    <description><![CDATA[密码（1-16位非空白符）]]></description>
                    <type>string</type>
                    <format>^\S{1,16}$</format>
                    <transform>#encrypt_md5</transform>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>role</name>
                    <description><![CDATA[角色名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>failed_retry_count</name>
                    <description><![CDATA[失败重试计数（新注册用户默认为0）]]></description>
                    <type>integer</type>
                    <format>#constant#</format>
                    <constant>0</constant>
                </parameter>
                <parameter>
                    <name>frozen_datetime</name>
                    <description><![CDATA[冻结时间（新注册用户默认为null）]]></description>
                    <type>timestamp</type>
                    <format>#constant#</format>
                    <constant>#null</constant>
                </parameter>
                <parameter>
                    <name>status</name>
                    <description><![CDATA[用户状态（1:正常 2:冻结 3:锁定）]]></description>
                    <type>integer</type>
                    <format>#constant#</format>
                    <constant>1</constant>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>addUserByRegister</name>
            <description><![CDATA[添加用户（前端注册）]]></description>
            <namespace>
                <![CDATA[
                    [!select][user_security][selectUser][name];
                    [insert][user_security][insertUser][uuid,name,password,role,failed_retry_count,frozen_datetime,status];
                    [select][user_security][selectUser][uuid];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>#constant#</format>
                    <constant>#uuid</constant>
                </parameter>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>password</name>
                    <description><![CDATA[密码（1-16位非空白符）]]></description>
                    <type>string</type>
                    <format>^\S{1,16}$</format>
                    <transform>#encrypt_md5</transform>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>role</name>
                    <description><![CDATA[角色名（注册用户角色常量）]]></description>
                    <type>string</type>
                    <format>#constant#</format>
                    <constant>member</constant>
                </parameter>
                <parameter>
                    <name>failed_retry_count</name>
                    <description><![CDATA[失败重试计数（新注册用户默认为0）]]></description>
                    <type>integer</type>
                    <format>#constant#</format>
                    <constant>0</constant>
                </parameter>
                <parameter>
                    <name>frozen_datetime</name>
                    <description><![CDATA[冻结时间（新注册用户默认为null）]]></description>
                    <type>timestamp</type>
                    <format>#constant#</format>
                    <constant>#null</constant>
                </parameter>
                <parameter>
                    <name>status</name>
                    <description><![CDATA[用户状态（1:正常 2:冻结 3:锁定）]]></description>
                    <type>integer</type>
                    <format>#constant#</format>
                    <constant>1</constant>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>removeUser</name>
            <description><![CDATA[删除用户]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectUser][uuid];
                    [delete][user_security][deleteUser][uuid];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z]{32}$</format>
                    <allowNull>false</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>modifyUserForPassword</name>
            <description><![CDATA[修改用户密码]]></description>
            <namespace>
                <![CDATA[
                    [update][user_security][updateUser][uuid,password];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[Session数据]]></description>
                    <type>string</type>
                    <format>#constant#</format>
                    <constant>#session_user_uuid</constant>
                </parameter>
                <parameter>
                    <name>password</name>
                    <description><![CDATA[密码（1-16位非空白符）]]></description>
                    <type>string</type>
                    <format>^\S{1,16}$</format>
                    <transform>#encrypt_md5</transform>
                    <allowNull>false</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>modifyUserByManager</name>
            <description><![CDATA[修改用户（管理员）]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectUser][uuid];
                    [update][user_security][updateUser][uuid,password,role,status];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z]{32}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>password</name>
                    <description><![CDATA[密码（1-16位非空白符）]]></description>
                    <type>string</type>
                    <format>^\S{1,16}$</format>
                    <transform>#encrypt_md5</transform>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>role</name>
                    <description><![CDATA[角色名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>status</name>
                    <description><![CDATA[用户状态（1:正常 2:冻结 3:锁定）]]></description>
                    <type>integer</type>
                    <format>^[123]$</format>
                    <allowNull>true</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>getUserForLogin</name>
            <description><![CDATA[获取用户（用于登录）]]></description>
            <namespace>
                <![CDATA[
                    [custom][user_security][module.user_security.necessary.Custom.login][name,password];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>false</allowNull>
                </parameter>
                <parameter>
                    <name>password</name>
                    <description><![CDATA[密码（1-16位非空白符）]]></description>
                    <type>string</type>
                    <format>^\S{1,16}$</format>
                    <transform>#encrypt_md5</transform>
                    <allowNull>false</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>getUserBySelf</name>
            <description><![CDATA[获取用户（自身获取）]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectUser][uuid];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[Session数据]]></description>
                    <type>string</type>
                    <format>#constant#</format>
                    <constant>#session_user_uuid</constant>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>getUserByManager</name>
            <description><![CDATA[获取用户（后台获取）]]></description>
            <namespace>
                <![CDATA[
                    [select][user_security][selectUser][uuid,name,password,failed_retry_count,status,offset,rows,data_type];
                ]]>
            </namespace>
            <parameters>
                <parameter>
                    <name>uuid</name>
                    <description><![CDATA[唯一标识]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z]{32}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>name</name>
                    <description><![CDATA[用户名（4-16位下划线、横线、字符或数字）]]></description>
                    <type>string</type>
                    <format>^[0-9a-zA-Z_-]{4,16}$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>password</name>
                    <description><![CDATA[密码（1-16位非空白符）]]></description>
                    <type>string</type>
                    <format>^\S{1,16}$</format>
                    <transform>#encrypt_md5</transform>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>failed_retry_count</name>
                    <description><![CDATA[失败重试计数（大于0的数字）]]></description>
                    <type>integer</type>
                    <format>^[0-9]+$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>status</name>
                    <description><![CDATA[用户状态（1:正常 2:冻结 3:锁定）]]></description>
                    <type>integer</type>
                    <format>^[123]$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>offset</name>
                    <description><![CDATA[偏移（大于等于0的数字）]]></description>
                    <type>integer</type>
                    <format>^[0-9]+$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>rows</name>
                    <description><![CDATA[行数（大于等于1的数字）]]></description>
                    <type>integer</type>
                    <format>^[1-9]+[0-9]*$</format>
                    <allowNull>true</allowNull>
                </parameter>
                <parameter>
                    <name>data_type</name>
                    <description><![CDATA[数据类型（count）]]></description>
                    <type>string</type>
                    <format>^count$</format>
                    <allowNull>true</allowNull>
                </parameter>
            </parameters>
        </servlet>
        <servlet>
            <name>logout</name>
            <description><![CDATA[登出]]></description>
            <namespace>
                <![CDATA[
                    [custom][user_security][module.user_security.necessary.Custom.logout][];
                ]]>
            </namespace>
        </servlet>
    </dispatch>
</config>
